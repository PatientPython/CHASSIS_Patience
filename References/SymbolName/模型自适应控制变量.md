# 模型自适应控制器变量命名

> 本文件由 `/name-symbol` 技能自动生成，请审查后确认。

## 理论来源

- **输入文件**：`References/ControlTheory/7_模型自适应控制.md`
- **理论概述**：模型自适应控制器（Model Self-adaptive Controller），通过牵引力控制和稳定性控制解决轮腿机器人打滑、受阻问题
- **生成日期**：2026-02-23

---

## 1. 物理量

> 角度、速度、力/力矩、长度等直接对应物理意义的变量

| # | 数学符号 | 物理含义 | 代码命名 | 类型 | 单位 | 取值范围 | 使用场景 |
|---|---------|---------|---------|------|------|---------|---------|
| 1 | v | 底盘线速度 | G_F_CH_VelFB | float | m/s | [-5, 5] | 卡尔曼滤波状态量 |
| 2 | a | 底盘加速度 | G_F_CH_AccFB | float | m/s² | [-20, 20] | 卡尔曼滤波状态量 |
| 3 | φ̇ | 偏航角速度（估计值） | G_F_CH_YawRateEst | float | rad/s | [-10, 10] | 偏航角速度估计 |
| 4 | φ̇_gyro | 陀螺仪偏航角速度 | G_F_CH_YawRateGyro | float | rad/s | [-10, 10] | IMU读取 |
| 5 | θ̇_w,l | 左轮角速度（实测） | G_F_CH_WheelAngVelL | float | rad/s | [-50, 50] | 轮速反馈 |
| 6 | θ̇_w,r | 右轮角速度（实测） | G_F_CH_WheelAngVelR | float | rad/s | [-50, 50] | 轮速反馈 |
| 7 | θ̇_w,l,des | 左轮角速度（理想/目标） | G_F_CH_WheelAngVelLDes | float | rad/s | [-50, 50] | 理想轮速计算 |
| 8 | θ̇_w,r,des | 右轮角速度（理想/目标） | G_F_CH_WheelAngVelRDes | float | rad/s | [-50, 50] | 理想轮速计算 |
| 9 | R_w | 轮子半径 | G_F_CH_WheelRadius | const float | m | - | 运动学参数 |
| 10 | R_l | 半轮距 | G_F_CH_HalfWheelbase | const float | m | - | 运动学参数 |
| 11 | ẋ_c | C点x坐标微分（髋关节） | G_F_CH_HipPointVelX | float | m/s | [-2, 2] | 理想轮速计算 |
| 12 | ŝ | 车身线速度（估计值） | G_F_CH_VelEst | float | m/s | [-5, 5] | 卡尔曼滤波输出 |
| 13 | E_HM1 | 左轮速误差（线速度维度） | G_F_CH_WheelErrL | float | m/s | [-10, 10] | 牵引力/稳定性计算 |
| 14 | E_HM2 | 右轮速误差（线速度维度） | G_F_CH_WheelErrR | float | m/s | [-10, 10] | 牵引力/稳定性计算 |
| 15 | ψ_target | 目标航向角 | G_F_CH_YawTarget | float | rad | [-π, π] | 偏航控制目标 |
| 16 | ψ_actual | 实际航向角 | G_F_CH_YawFB | float | rad | [-π, π] | 偏航反馈 |
| 17 | T_traction,l | 左轮牵引力矩 | G_F_CH_TractionTorqueL | float | N·m | [-5, 5] | 牵引力输出 |
| 18 | T_traction,r | 右轮牵引力矩 | G_F_CH_TractionTorqueR | float | N·m | [-5, 5] | 牵引力输出 |
| 19 | T_stability,L | 左轮稳定性力矩 | G_F_CH_StabilityTorqueL | float | N·m | [-5, 5] | 稳定性输出 |
| 20 | T_stability,R | 右轮稳定性力矩 | G_F_CH_StabilityTorqueR | float | N·m | [-5, 5] | 稳定性输出 |
| 21 | T_adapt | 总自适应力矩 | G_F_CH_AdaptTorque | float | N·m | [-10, 10] | 最终输出 |
| 22 | T_adapt,L | 左轮自适应力矩 | G_F_CH_AdaptTorqueL | float | N·m | [-5, 5] | 左轮最终输出 |
| 23 | T_adapt,R | 右轮自适应力矩 | G_F_CH_AdaptTorqueR | float | N·m | [-5, 5] | 右轮最终输出 |
| 24 | T_yaw_req | 偏航力矩需求 | G_F_CH_YawTorqueReq | float | N·m | [-5, 5] | 偏航控制 |
| 25 | W_L | 左轮权重 | G_F_CH_WeightL | float | [0,1] | - | 动态权重 |
| 26 | W_R | 右轮权重 | G_F_CH_WeightR | float | [0,1] | - | 动态权重 |

---

## 2. 控制变量

> 目标值(Ref)、反馈值(Fdb)、误差(Err)、控制输出(Out)

| # | 数学符号 | 物理含义 | 代码命名 | 类型 | 单位 | 取值范围 | 使用场景 |
|---|---------|---------|---------|------|------|---------|---------|
| 1 | v_body_obs | 基于轮速解算的车身速度 | G_F_CH_VelObsFromWheel | float | m/s | [-5, 5] | 卡尔曼滤波观测输入 |
| 2 | a_imu | IMU测得X轴加速度 | G_F_CH_AccIMU | float | m/s² | [-20, 20] | 卡尔曼滤波观测输入 |
| 3 | v_wheel | 轮速计速度 | G_F_CH_VelWheel | float | m/s | [-5, 5] | 轮速观测 |

---

## 3. 状态变量

> 状态空间模型中的状态向量分量

| # | 状态向量位置 | 数学符号 | 物理含义 | 代码命名 | 类型 | 单位 |
|---|------------|---------|---------|---------|------|------|
| 1 | x[0] | v̂ | 底盘速度（估计） | G_F_CH_StateVel | float | m/s |
| 2 | x[1] | â | 底盘加速度（估计） | G_F_CH_StateAcc | float | m/s² |

---

## 4. 参数与常量

> PID增益、物理常数、限幅值等不变或很少变化的量

| # | 数学符号 | 含义 | 代码命名 | 类型 | 值 | 备注 |
|---|---------|------|---------|------|-----|------|
| 1 | K_traction | 牵引力增益系数 | G_F_CH_KTraction | const float | 待整定 | 牵引力控制 |
| 2 | K_stability | 稳定性增益系数 | G_F_CH_KStability | const float | 待整定 | 偏航控制 |
| 3 | α | 最大调节幅度 | G_F_CH_AlphaMaxAdj | const float | 0.6f | 权重调节范围 |
| 4 | δ | 死区阈值 | G_F_CH_DeadZone | const float | 0.5f | m/s，打滑判定门限 |
| 5 | E_sat | 饱和阈值 | G_F_CH_ErrSat | const float | 待整定 | 误差饱和值 |
| 6 | Δt | 采样时间 | G_F_CH_DeltaT | const float | 0.001f | 1ms，对应1kHz |
| 7 | F | 状态转移矩阵 | G_F_CH_MatF[2][2] | const float[2][2] | {{1,Δt},{0,1}} | 卡尔曼滤波 |
| 8 | H | 观测矩阵 | G_F_CH_MatH[2][2] | const float[2][2] | {{1,0},{0,1}} | 卡尔曼滤波 |
| 9 | Q_kf | 过程噪声协方差 | G_F_CH_MatQ | float[2][2] | 待整定 | 卡尔曼滤波 |
| 10 | R_kf | 观测噪声协方差 | G_F_CH_MatR | float[2][2] | 待整定 | 卡尔曼滤波 |

---

## 5. 中间计算量

> 推导过程中的中间变量，通常为局部变量

| # | 数学符号 | 含义 | 代码命名 | 类型 | 出现函数 |
|---|---------|------|---------|------|---------|
| 1 | λ | 状态强度系数 | lambda | float | 自适应权重计算 |
| 2 | IsSlip | 打滑指示函数 | is_slip | int (bool) | 权重计算 |
| 3 | IsBlock | 受阻指示函数 | is_block | int (bool) | 权重计算 |
| 4 | P | 估计协方差矩阵 | P_kf | float[2][2] | 卡尔曼滤波更新 |
| 5 | K_kf | 卡尔曼增益 | K_kalman | float[2][2] | 卡尔曼滤波更新 |
| 6 | y_innov | 观测创新量 | innovation | float[2] | 卡尔曼滤波更新 |

---

## 6. 结构体定义

> 将相关变量组织成结构体

| # | 结构体类型名 | 实例名 | 包含成员 | 用途 |
|---|------------|--------|---------|------|
| 1 | ST_CH_AdaptControl | st_CH_AdaptCtrl | KTraction, KStability, AlphaMax, DeadZone, ErrSat | 模型自适应控制参数 |
| 2 | ST_CH_KalmanState | st_CH_KfState | StateVel, StateAcc, MatP | 卡尔曼滤波状态 |
| 3 | ST_CH_WheelErr | st_CH_WheelErr | ErrL, ErrR | 左右轮速误差 |
| 4 | ST_CH_YawControl | st_CH_YawCtrl | YawTarget, YawFB, TorqueReq, WeightL, WeightR | 偏航/稳定性控制 |
| 5 | ST_CH_AdaptOutput | st_CH_AdaptOut | TorqueL, TorqueR, TorqueTotal | 自适应输出 |

---

## 7. 枚举定义

> 状态机状态、模式选择等

| # | 枚举类型名 | 枚举值 | 含义 |
|---|-----------|-------|------|
| 1 | EM_CH_WheelState | WHEEL_STATE_NORMAL = 0 | 正常状态 |
| | | WHEEL_STATE_SLIP = 1 | 打滑状态 |
| | | WHEEL_STATE_BLOCK = 2 | 受阻状态 |
| 2 | EM_CH_AdaptMode | ADAPT_MODE_DISABLE = 0 | 自适应关闭 |
| | | ADAPT_MODE_ENABLE = 1 | 自适应开启 |
| | | ADAPT_MODE_TEST = 2 | 自适应测试模式 |

---

## 命名规范摘要

- 全局变量：`G_[类型][模块]_描述`（如 `G_F_CH_VelFB`）
- 静态变量：`S_[类型][模块]_描述`
- 局部变量：直接描述（如 `lambda`）
- 结构体类型：`ST_Xxx`，实例：`st_XX_Xxx`
- 枚举类型：`EM_Xxx`，值：`XXX_STATE_NAME`
- 宏/常量：`G_F_CH_KTRACTION`（全大写下划线）
- 函数：公开无前缀，内部 `_` 前缀，底层 `__` 前缀
